{"remainingRequest":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\nuno_\\Desktop\\q1w2\\client\\src\\views\\BookManually.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\src\\views\\BookManually.vue","mtime":1547255781337},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _JSON$stringify from \"C:\\\\Users\\\\nuno_\\\\Desktop\\\\q1w2\\\\client\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport _Object$keys from \"C:\\\\Users\\\\nuno_\\\\Desktop\\\\q1w2\\\\client\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\nuno_\\\\Desktop\\\\q1w2\\\\client\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport BookService from '@/services/BookService';\nimport PersonalReadingService from '@/services/PersonalReadingService';\nimport Datepicker from 'vuejs-datepicker';\nexport default {\n  name: 'book-manually',\n  components: {\n    Datepicker: Datepicker\n  },\n  data: function data() {\n    return {\n      book: {\n        title: null,\n        subtitle: null,\n        authors: null,\n        publishDate: 'Please fill',\n        nrPages: null,\n        publisher: null,\n        language: null,\n        thumbnailUrl: null\n      },\n      reading: null,\n      optionsReading: ['I already have read this book', 'I haven\\'t started it yet.', 'I\\'ve started but I haven\\'t finshed yet.'],\n      date: null,\n      dateStart: null,\n      dateEnd: null,\n      modal: false,\n      modalStart: null,\n      modalEnd: null,\n      error: null,\n      success: null,\n      dialog: false,\n      dialogStart: false,\n      //datepicker : false,\n      required: function required(value) {\n        return !!value || 'Required.';\n      }\n    };\n  },\n  methods: {\n    createBook: function () {\n      var _createBook = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var areAllFieldsFilledIn, readingStatus, startDate, endDate, responseBook, personalReadingResponse;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.error = null;\n\n                if (!this.subtitle) {\n                  this.book.subtitle = 'No subtitle';\n                }\n\n                areAllFieldsFilledIn = _Object$keys(this.book).every(function (key) {\n                  return !!_this.book[key];\n                });\n\n                if (areAllFieldsFilledIn) {\n                  _context.next = 7;\n                  break;\n                }\n\n                this.error = 'Please fill all the required fields';\n                this.dialog = false;\n                return _context.abrupt(\"return\");\n\n              case 7:\n                readingStatus = 0;\n                startDate = null;\n                endDate = null;\n\n                if (this.reading == this.optionsReading[0]) {\n                  readingStatus = 1;\n                  startDate = this.dateStart;\n                  endDate = this.dateEnd;\n                } else if (this.reading == this.optionsReading[1]) {\n                  readingStatus = 0;\n                } else if (this.reading == this.optionsReading[2]) {\n                  readingStatus = 2;\n                  startDate = this.dateStart;\n                }\n\n                alert(readingStatus);\n                _context.prev = 12;\n                _context.next = 15;\n                return BookService.createBook(this.book);\n\n              case 15:\n                responseBook = _context.sent;\n                personalReadingResponse = null;\n\n                if (!responseBook.data.message) {\n                  _context.next = 23;\n                  break;\n                }\n\n                _context.next = 20;\n                return PersonalReadingService.createPersonalReading({\n                  LibraryId: this.$store.state.library.id,\n                  UserId: this.$store.state.user.id,\n                  BookId: this.$route.params.BookId,\n                  reading: readingStatus,\n                  startDate: startDate,\n                  endDate: endDate\n                });\n\n              case 20:\n                personalReadingResponse = _context.sent;\n                _context.next = 26;\n                break;\n\n              case 23:\n                _context.next = 25;\n                return PersonalReadingService.createPersonalReading({\n                  LibraryId: this.$store.state.library.id,\n                  UserId: this.$store.state.user.id,\n                  BookId: responseBook.data.id,\n                  reading: readingStatus,\n                  startDate: startDate,\n                  endDate: endDate\n                });\n\n              case 25:\n                personalReadingResponse = _context.sent;\n\n              case 26:\n                this.success = \"\".concat(this.book.title, \" added to your library\");\n                this.dialog = false;\n                _context.next = 35;\n                break;\n\n              case 30:\n                _context.prev = 30;\n                _context.t0 = _context[\"catch\"](12);\n                this.success = null;\n                this.dialog = false;\n                this.error = _context.t0.response.data.error;\n\n              case 35:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[12, 30]]);\n      }));\n\n      function createBook() {\n        return _createBook.apply(this, arguments);\n      }\n\n      return createBook;\n    }()\n  },\n  rules: {\n    required: function required(value) {\n      return !!value || 'Required.';\n    }\n  },\n  watch: {\n    'this.$route.params.book': {\n      immediate: true,\n      handler: function () {\n        var _handler = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee2(value) {\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  alert(value);\n                  alert('hey'); // const bookApi = (Buffer.from(this.$route.params.Book, 'base64').toString('ascii'))\n                  // const bookJson = JSON.parse(bookApi)\n                  // this.book.title = bookJson.title\n                  // this.book.subtitle = bookJson.subtitle\n                  // this.book.authors =  JSON.stringify(bookJson.authors).replace(/\"/g,'').replace(/\\[/,'').replace(/\\]/, '').replace(/,/,', ')\n                  // this.book.publishDate = bookJson.publishedDate.substring(0,10)\n                  // this.book.nrPages = bookJson.pageCount\n                  // this.book.publisher =bookJson.publisher\n                  // this.book.language = bookJson.language\n                  // this.book.thumbnailUrl = bookJson.thumbnail\n\n                case 2:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }));\n\n        function handler(_x) {\n          return _handler.apply(this, arguments);\n        }\n\n        return handler;\n      }()\n    }\n  },\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee3() {\n      var bookId, book, bookApi, bookJson;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              alert('tabs' + this.$parent.tabs);\n\n              if (!this.$route.params.BookId) {\n                _context3.next = 16;\n                break;\n              }\n\n              bookId = this.$route.params.BookId;\n              _context3.next = 5;\n              return BookService.getBookById(bookId);\n\n            case 5:\n              book = _context3.sent;\n              this.book.title = book.data.title;\n              this.book.subtitle = book.data.subtitle;\n              this.book.authors = book.data.authors;\n              this.book.publishDate = book.data.publishDate.substring(0, 10);\n              this.book.nrPages = book.data.nrPages;\n              this.book.publisher = book.data.publisher;\n              this.book.language = book.data.language;\n              this.book.thumbnailUrl = book.data.thumbnailUrl;\n              _context3.next = 17;\n              break;\n\n            case 16:\n              if (this.$route.params.Book) {\n                bookApi = Buffer.from(this.$route.params.Book, 'base64').toString('ascii');\n                bookJson = JSON.parse(bookApi);\n                this.book.title = bookJson.title;\n                this.book.subtitle = bookJson.subtitle;\n                this.book.authors = _JSON$stringify(bookJson.authors).replace(/\"/g, '').replace(/\\[/, '').replace(/\\]/, '').replace(/,/, ', ');\n                this.book.publishDate = bookJson.publishedDate.substring(0, 10);\n                this.book.nrPages = bookJson.pageCount;\n                this.book.publisher = bookJson.publisher;\n                this.book.language = bookJson.language;\n                this.book.thumbnailUrl = bookJson.thumbnail;\n              }\n\n            case 17:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }()\n};",{"version":3,"sources":["BookManually.vue"],"names":[],"mappings":"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","sourcesContent":["<script>\r\n/* eslint-disable */\r\n</script>\r\n<template>\r\n  <panel title=\"AddBookManuallyPanel\">\r\n    <v-flex xs12 md12>\r\n      <v-text-field label=\"Title\"  required :rules=\"[required]\" v-model=\"book.title\"></v-text-field>\r\n    </v-flex>\r\n    <v-flex xs12 md12>\r\n      <v-text-field label=\"Subtitle\"  v-model=\"book.subtitle\"></v-text-field>\r\n    </v-flex> \r\n    <v-flex xs12 md12>\r\n      <v-text-field label=\"Authors\"  required :rules=\"[required]\" v-model=\"book.authors\"></v-text-field>   \r\n    </v-flex>\r\n    <!-- <v-flex xs12 md12>\r\n        <v-text-field slot=\"beforeCalendarHeader\" v-model=\"book.publishDate\" label=\"Publish date\"  readonly></v-text-field>\r\n        <datepicker v-model=\"book.publishDate\" placeholder=\"Publish date\"></datepicker>\r\n    </v-flex> -->\r\n    <v-flex xs12 sm6 md4>\r\n        <v-dialog ref=\"dialog\" v-model=\"modal\" :return-value.sync=\"date\" persistent lazy full-width width=\"290px\">\r\n          <v-text-field slot=\"activator\"   v-model=\"date\" label=\"Picker in dialog\" prepend-icon=\"event\" readonly>\r\n          </v-text-field>\r\n          <v-date-picker v-model=\"date\" scrollable>\r\n            <v-spacer></v-spacer>\r\n            <v-btn flat color=\"primary\" @click=\"modal = false\">Cancel</v-btn>\r\n            <v-btn flat color=\"primary\" @click=\"$refs.dialog.save(date)\">OK</v-btn>\r\n          </v-date-picker>\r\n        </v-dialog>\r\n      </v-flex>\r\n    <v-flex xs12 md12>\r\n      <v-text-field label=\"Number of pages\" type=\"number\" required :rules=\"[required]\"  v-model=\"book.nrPages\"></v-text-field>\r\n    </v-flex>\r\n    <v-flex xs12 md12>\r\n      <v-text-field label=\"Publisher\"  v-model=\"book.publisher\"></v-text-field>\r\n    </v-flex>\r\n    <v-flex xs12 md12>\r\n      <v-text-field label=\"Language\" required :rules=\"[required]\"  v-model=\"book.language\"></v-text-field>\r\n    </v-flex>\r\n    <v-flex xs12 md12>\r\n      <v-text-field label=\"Thumbnail URL\" required :rules=\"[required]\"  v-model=\"book.thumbnailUrl\"></v-text-field>\r\n    </v-flex>\r\n    <v-flex xs12 ms6 md4>\r\n      <v-select :items=\"optionsReading\" v-model=\"reading\" label=\"Reading status\"></v-select>\r\n      <v-dialog v-if=\"this.reading==this.optionsReading[0] || this.reading==this.optionsReading[2]\" ref=\"dialogStart\" v-model=\"modalStart\" :return-value.sync=\"date\" persistent lazy full-width width=\"290px\">\r\n          <v-text-field slot=\"activator\" v-model=\"dateStart\" label=\"Start date\" prepend-icon=\"event\" readonly>\r\n          </v-text-field>\r\n          <v-date-picker v-model=\"dateStart\" scrollable>\r\n            <v-spacer></v-spacer>\r\n            <v-btn flat color=\"primary\" @click=\"modalStart = false\">Cancel</v-btn>\r\n            <v-btn flat color=\"primary\" @click=\"$refs.dialogStart.save(date)\">OK</v-btn>\r\n          </v-date-picker>\r\n      </v-dialog>\r\n      <v-dialog v-if=\"this.reading==this.optionsReading[0]\" ref=\"dialogEnd\" v-model=\"modalEnd\" :return-value.sync=\"date\" persistent lazy full-width width=\"290px\">\r\n          <v-text-field slot=\"activator\" v-model=\"dateEnd\" label=\"Finish date\" prepend-icon=\"event\" readonly>\r\n          </v-text-field>\r\n          <v-date-picker v-model=\"dateEnd\" scrollable>\r\n            <v-spacer></v-spacer>\r\n            <v-btn flat color=\"primary\" @click=\"modalEnd = false\">Cancel</v-btn>\r\n            <v-btn flat color=\"primary\" @click=\"$refs.dialogEnd.save(date)\">OK</v-btn>\r\n          </v-date-picker>\r\n        </v-dialog>  \r\n    </v-flex>\r\n    <br><br>\r\n    <v-alert v-if=\"success\" :value=\"true\" type=\"success\">\r\n      {{success}}.\r\n    </v-alert>\r\n    <v-alert  v-if=\"error\" :value=\"true\" type=\"error\">\r\n      {{error}}\r\n    </v-alert>\r\n    <br>\r\n    <v-flex xs12 text-xs-right>\r\n    <v-btn color=\"success\" @click=\"dialog = true\">\r\n      Submit\r\n    </v-btn>\r\n    </v-flex>\r\n    <v-layout row justify-center>\r\n      <v-dialog v-model=\"dialog\" persistent max-width=\"290\">\r\n        <v-card>\r\n          <v-card-title class=\"headline\">Warning</v-card-title>\r\n          <v-card-text>Are you sure you want to add {{book.title}} to your library?</v-card-text>\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn color=\"green darken-1\" flat @click=\"createBook\">Yes</v-btn>\r\n            <v-btn color=\"green darken-1\" flat @click=\"dialog = false\">No</v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n      </v-dialog>\r\n    </v-layout>\r\n  </panel>\r\n</template>\r\n\r\n<script>\r\n  import BookService from '@/services/BookService'\r\n  import PersonalReadingService from '@/services/PersonalReadingService'\r\n  import Datepicker from 'vuejs-datepicker'\r\n  \r\n  export default {\r\n    name: 'book-manually',\r\n    components: {\r\n      Datepicker\r\n    },\r\n      data() {\r\n        return {\r\n          book: {\r\n            title: null,\r\n            subtitle: null,\r\n            authors: null,\r\n            publishDate: 'Please fill',\r\n            nrPages: null,\r\n            publisher: null,\r\n            language: null,\r\n            thumbnailUrl : null\r\n          },\r\n          reading: null,\r\n          optionsReading : ['I already have read this book', 'I haven\\'t started it yet.', 'I\\'ve started but I haven\\'t finshed yet.'],\r\n          date: null,\r\n          dateStart: null,\r\n          dateEnd: null,\r\n          modal: false,\r\n          modalStart: null,\r\n          modalEnd: null,\r\n          error: null,\r\n          success: null,\r\n          dialog: false,\r\n          dialogStart: false,\r\n          //datepicker : false,\r\n          required: (value) => !!value || 'Required.'\r\n        }\r\n      },\r\n      methods: {\r\n        async createBook() {\r\n          this.error = null\r\n          if (!(this.subtitle)){\r\n            this.book.subtitle = 'No subtitle'\r\n          }\r\n          const areAllFieldsFilledIn = Object\r\n            .keys(this.book)\r\n            .every(key => !!this.book[key])\r\n            if (!areAllFieldsFilledIn){\r\n              this.error= 'Please fill all the required fields'\r\n              this.dialog = false\r\n              return\r\n            }\r\n          let readingStatus = 0\r\n          let startDate = null\r\n          let endDate = null\r\n          if (this.reading == this.optionsReading[0]){\r\n            readingStatus = 1\r\n            startDate = this.dateStart\r\n            endDate = this.dateEnd\r\n          } else if (this.reading == this.optionsReading[1]) {\r\n            readingStatus = 0\r\n          } else if (this.reading == this.optionsReading[2]) {\r\n            readingStatus = 2\r\n            startDate = this.dateStart\r\n          }\r\n          alert(readingStatus )\r\n          try {\r\n            const responseBook = await BookService.createBook(this.book)\r\n            let personalReadingResponse = null\r\n            if (responseBook.data.message){\r\n              personalReadingResponse = await PersonalReadingService.createPersonalReading({\r\n              LibraryId : this.$store.state.library.id,\r\n              UserId : this.$store.state.user.id,\r\n              BookId : this.$route.params.BookId,\r\n              reading: readingStatus,\r\n              startDate: startDate,\r\n              endDate: endDate\r\n            })\r\n            } else {\r\n            personalReadingResponse = await PersonalReadingService.createPersonalReading({\r\n              LibraryId : this.$store.state.library.id,\r\n              UserId : this.$store.state.user.id,\r\n              BookId : responseBook.data.id,\r\n              reading: readingStatus,\r\n              startDate: startDate,\r\n              endDate: endDate\r\n            })\r\n            \r\n            }\r\n            this.success = `${this.book.title} added to your library`\r\n            this.dialog = false\r\n          } catch (error) {\r\n            this.success = null\r\n            this.dialog = false\r\n            this.error = error.response.data.error\r\n          }\r\n        }\r\n      },\r\n      rules: {\r\n        required: (value) => !!value || 'Required.'\r\n      },\r\n      watch: {\r\n        'this.$route.params.book': {\r\n          immediate: true,\r\n          async handler(value) {\r\n            alert(value)\r\n            alert('hey')\r\n          // const bookApi = (Buffer.from(this.$route.params.Book, 'base64').toString('ascii'))\r\n          // const bookJson = JSON.parse(bookApi)\r\n          // this.book.title = bookJson.title\r\n          // this.book.subtitle = bookJson.subtitle\r\n          // this.book.authors =  JSON.stringify(bookJson.authors).replace(/\"/g,'').replace(/\\[/,'').replace(/\\]/, '').replace(/,/,', ')\r\n          // this.book.publishDate = bookJson.publishedDate.substring(0,10)\r\n          // this.book.nrPages = bookJson.pageCount\r\n          // this.book.publisher =bookJson.publisher\r\n          // this.book.language = bookJson.language\r\n          // this.book.thumbnailUrl = bookJson.thumbnail\r\n          }\r\n        }\r\n      },\r\n      async mounted () {\r\n        alert('tabs'+this.$parent.tabs)\r\n        if (this.$route.params.BookId){\r\n          let bookId = this.$route.params.BookId\r\n          const book = await BookService.getBookById(bookId)\r\n          this.book.title = book.data.title\r\n          this.book.subtitle = book.data.subtitle\r\n          this.book.authors = book.data.authors\r\n          this.book.publishDate = book.data.publishDate.substring(0,10)\r\n          this.book.nrPages = book.data.nrPages\r\n          this.book.publisher = book.data.publisher\r\n          this.book.language = book.data.language\r\n          this.book.thumbnailUrl = book.data.thumbnailUrl\r\n        } else if (this.$route.params.Book){\r\n          const bookApi = (Buffer.from(this.$route.params.Book, 'base64').toString('ascii'))\r\n          const bookJson = JSON.parse(bookApi)\r\n          this.book.title = bookJson.title\r\n          this.book.subtitle = bookJson.subtitle\r\n          this.book.authors =  JSON.stringify(bookJson.authors).replace(/\"/g,'').replace(/\\[/,'').replace(/\\]/, '').replace(/,/,', ')\r\n          this.book.publishDate = bookJson.publishedDate.substring(0,10)\r\n          this.book.nrPages = bookJson.pageCount\r\n          this.book.publisher =bookJson.publisher\r\n          this.book.language = bookJson.language\r\n          this.book.thumbnailUrl = bookJson.thumbnail\r\n        }\r\n      }\r\n  }\r\n</script>\r\n\r\n"],"sourceRoot":"src\\views"}]}