{"remainingRequest":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\nuno_\\Desktop\\q1w2\\client\\src\\views\\ManageLibrary.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\src\\views\\ManageLibrary.vue","mtime":1547386091085},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\nuno_\\Desktop\\q1w2\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _Object$keys from \"C:\\\\Users\\\\nuno_\\\\Desktop\\\\q1w2\\\\client\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\nuno_\\\\Desktop\\\\q1w2\\\\client\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"C:\\\\Users\\\\nuno_\\\\Desktop\\\\q1w2\\\\client\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport LibraryService from '@/services/LibraryService';\nimport AuthenticationService from '@/services/AuthenticationService';\nimport { mapState } from 'vuex';\nexport default {\n  computed: _objectSpread({}, mapState(['user'])),\n  data: function data() {\n    return {\n      snackbar: false,\n      snackbarSuccess: false,\n      snackbarError: false,\n      color: null,\n      snackbarMessage: '',\n      invitation: {\n        email: null\n      },\n      error: null,\n      dialog: false,\n      dialogRemove: false,\n      required: function required(value) {\n        return !!value || 'Required.';\n      },\n      users: [],\n      search: '',\n      headers: [{\n        class: 'idcolumn',\n        sortable: true,\n        text: 'Id',\n        value: 'userId'\n      }, {\n        sortable: false,\n        text: 'Name',\n        value: 'name'\n      }, {\n        sortable: false,\n        text: 'Surname',\n        value: 'surname'\n      }, {\n        sortable: true,\n        text: 'Username',\n        value: 'username'\n      }, {\n        sortable: true,\n        text: 'E-mail',\n        value: 'email'\n      }, {\n        sortable: true,\n        text: 'Remove',\n        align: 'center'\n      }]\n    };\n  },\n  methods: {\n    invite: function () {\n      var _invite = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var areAllFieldsFilledIn, response;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                this.error = null;\n                areAllFieldsFilledIn = _Object$keys(this.invitation).every(function (key) {\n                  return !!_this.invitation[key];\n                });\n\n                if (areAllFieldsFilledIn) {\n                  _context.next = 7;\n                  break;\n                }\n\n                this.error = 'Please fill all the required fields';\n                this.dialog = false;\n                return _context.abrupt(\"return\");\n\n              case 7:\n                _context.next = 9;\n                return LibraryService.invite({\n                  usernameInviter: this.$store.state.user.username,\n                  emailInvited: this.invitation.email,\n                  libraryId: this.$store.state.library.id\n                });\n\n              case 9:\n                response = _context.sent;\n                this.color = \"success\";\n                this.snackbarError = false;\n                this.snackbarSuccess = true;\n                this.snackbarMessage = 'Invitation sent';\n                this.snackbar = true;\n                this.dialog = false;\n                _context.next = 27;\n                break;\n\n              case 18:\n                _context.prev = 18;\n                _context.t0 = _context[\"catch\"](0);\n                alert('Some error happened. Please try again.');\n                this.color = \"error\";\n                this.snackbarSuccess = false;\n                this.snackbarError = true;\n                this.snackbarMessage = \"Some error happened. Please try again later.\";\n                this.snackbar = true;\n                this.dialog = false;\n\n              case 27:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 18]]);\n      }));\n\n      function invite() {\n        return _invite.apply(this, arguments);\n      }\n\n      return invite;\n    }(),\n    deleteItem: function () {\n      var _deleteItem = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(item) {\n        var index, response;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                index = this.users.indexOf(item);\n                _context2.next = 3;\n                return LibraryService.removeUserFromLibrary(this.$store.state.library.id, item.userId);\n\n              case 3:\n                response = _context2.sent.data;\n\n                if (response) {\n                  confirm(\"Are you sure you want to delete @\".concat(item.username, \" from your library?\")) && this.users.splice(index, 1);\n                  this.color = \"success\";\n                  this.snackbarError = false;\n                  this.snackbarSuccess = true;\n                  this.snackbarMessage = \"User deleted successfully.\";\n                  this.snackbar = true;\n                }\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function deleteItem(_x) {\n        return _deleteItem.apply(this, arguments);\n      }\n\n      return deleteItem;\n    }()\n  },\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee3() {\n      var libraryInvitations, i, obj, user, x;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return LibraryService.getAllLibraryInvitationsByLibraryId(this.$store.state.library.id);\n\n            case 2:\n              libraryInvitations = _context3.sent.data;\n              i = 0;\n\n            case 4:\n              if (!(i < libraryInvitations.length)) {\n                _context3.next = 13;\n                break;\n              }\n\n              obj = libraryInvitations[i];\n              _context3.next = 8;\n              return AuthenticationService.getUserById(obj.UserId);\n\n            case 8:\n              user = _context3.sent.data;\n              this.users.push({\n                userId: user.id,\n                name: user.name,\n                surname: user.surname,\n                username: user.username,\n                birthDate: user.birthDate,\n                email: user.email\n              });\n\n            case 10:\n              i++;\n              _context3.next = 4;\n              break;\n\n            case 13:\n              x = document.getElementsByClassName(\"idcolumn\");\n              x[0].style.display = \"none\";\n\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }()\n};",{"version":3,"sources":["ManageLibrary.vue"],"names":[],"mappings":"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","sourcesContent":["<script>\n/*eslint-disable */\n</script>\n\n<template>\n  <v-container fill-height fluid grid-list-xl>\n    <v-layout justify-center wrap>\n      <v-snackbar :color=\"this.color\"  top v-model=\"snackbar\" dark>\n        <v-icon v-if=\"snackbarSuccess\" color=\"white\" class=\"mr-3\">mdi-check</v-icon>\n        <v-icon v-if=\"snackbarError\" color=\"white\" class=\"mr-3\">mdi-alert-circle</v-icon>\n        <div> {{this.snackbarMessage}}  </div>\n        <v-icon size=\"16\" @click=\"snackbar = false\">mdi-close-circle</v-icon>\n      </v-snackbar>\n      <v-flex xs12 md8>\n        <material-card color=\"green\" title=\"Manage Library\">\n          <v-form>\n            <v-container py-0>\n              <v-layout wrap>\n                  <v-spacer></v-spacer>\n                    <v-flex xs12 md3>\n                    <v-text-field v-model=\"search\" append-icon=\"search\" label=\"Search\" single-line hide-details></v-text-field>\n                    </v-flex> \n                    <v-flex xs12 md6></v-flex>\n                    <v-flex xs12 md3>\n                      <v-btn color=\"green\" dark class=\"mb-2\" @click=\"dialog = true\">\n                        Invite someone\n                      </v-btn>\n                    </v-flex>\n                    <v-flex xs12 md12>\n                      <v-data-table :headers=\"headers\" :items=\"users\" :search=\"search\">\n                        <template slot=\"headerCell\" slot-scope=\"{ header }\">\n                          <span class=\"font-weight-light text-warning text--darken-3\" v-text=\"header.text\" />\n                        </template>\n                        <template slot=\"items\" slot-scope=\"props\">\n                          <td style=\"display: none;\">\n                            {{ props.item.userId }}</td>\n                          <td>{{ props.item.name }}</td>\n                          <td>{{ props.item.surname }}</td>\n                          <td>{{ props.item.username }}</td>\n                          <td>{{ props.item.email }}</td>\n                          <td><center><v-icon @click=\"deleteItem(props.item)\">mdi-delete</v-icon></center></td>\n                        </template>  \n                      </v-data-table>\n                    </v-flex>\n              </v-layout>\n              <v-layout row justify-center>\n                <v-dialog v-model=\"dialog\" persistent max-width=\"600px\">\n                  <v-card>\n                    <v-card-title>\n                      <span class=\"headline\">Invite someone to {{$store.state.library.name}}</span>\n                    </v-card-title>\n                    <v-card-text>\n                      <v-container grid-list-md>\n                        <v-layout wrap>\n                          <v-flex xs12>\n                            <v-text-field label=\"Email\" required :rules=\"[required]\" v-model=\"invitation.email\"></v-text-field>\n                          </v-flex>\n                        </v-layout>\n                      </v-container>\n                    </v-card-text>\n                    <v-card-actions>\n                      <v-spacer></v-spacer>\n                      <v-btn color=\"blue darken-1\" flat @click=\"dialog = false\">Close</v-btn>\n                      <v-btn color=\"blue darken-1\" flat @click=\"invite\">Save</v-btn>\n                    </v-card-actions>\n                  </v-card>\n                </v-dialog>\n              </v-layout>\n            </v-container>   \n          </v-form>\n        </material-card>\n      </v-flex>\n    </v-layout>\n  </v-container>\n</template>\n\n<script>\n  import LibraryService from '@/services/LibraryService'\n  import AuthenticationService from '@/services/AuthenticationService'\n\n  import {\n    mapState\n  } from 'vuex'\n  export default {\n    computed: {\n      ...mapState([\n        'user'\n      ])\n    },\n    data() {\n      return {\n        snackbar: false,\n        snackbarSuccess: false,\n        snackbarError: false,\n        color: null,\n        snackbarMessage : '',\n        invitation: {\n          email: null\n        },\n        error: null,\n        dialog: false,\n        dialogRemove: false,\n        required: (value) => !!value || 'Required.',\n        users: [],\n        search: '',\n        headers: [{\n            class: 'idcolumn',\n            sortable: true,\n            text: 'Id',\n            value: 'userId',\n          },\n          {\n            sortable: false,\n            text: 'Name',\n            value: 'name'\n          },\n          {\n            sortable: false,\n            text: 'Surname',\n            value: 'surname'\n          },\n          {\n            sortable: true,\n            text: 'Username',\n            value: 'username'\n          },\n          {\n            sortable: true,\n            text: 'E-mail',\n            value: 'email'\n          },\n          {\n            sortable: true,\n            text: 'Remove',\n            align: 'center'\n          }\n        ],\n      }\n    },\n    methods: {\n      async invite() {\n        try {\n          this.error = null\n          const areAllFieldsFilledIn = Object\n            .keys(this.invitation)\n            .every(key => !!this.invitation[key])\n          if (!areAllFieldsFilledIn) {\n            this.error = 'Please fill all the required fields'\n            this.dialog = false\n            return\n          }\n          const response = await LibraryService.invite({\n            usernameInviter: this.$store.state.user.username,\n            emailInvited: this.invitation.email,\n            libraryId: this.$store.state.library.id\n          })\n          this.color = \"success\"\n          this.snackbarError = false\n          this.snackbarSuccess = true\n          this.snackbarMessage = 'Invitation sent'\n          this.snackbar= true\n          this.dialog = false\n\n        } catch (error) {\n          alert('Some error happened. Please try again.')\n          this.color = \"error\"\n          this.snackbarSuccess = false\n          this.snackbarError = true\n          this.snackbarMessage = \"Some error happened. Please try again later.\"\n          this.snackbar= true\n          this.dialog = false\n        }\n      },\n      async deleteItem (item) {\n        const index = this.users.indexOf(item)\n        const response = (await LibraryService.removeUserFromLibrary(this.$store.state.library.id, item.userId)).data\n        if (response) {\n          confirm(`Are you sure you want to delete @${item.username} from your library?`) && this.users.splice(index, 1)\n          this.color = \"success\"\n          this.snackbarError = false\n          this.snackbarSuccess = true\n          this.snackbarMessage = \"User deleted successfully.\"\n          this.snackbar= true\n        }\n      }\n    },\n    async mounted () {\n      const libraryInvitations = (await LibraryService.getAllLibraryInvitationsByLibraryId(this.$store.state.library.id)).data\n          for (var i = 0; i < libraryInvitations.length; i++) {\n            var obj=libraryInvitations[i]\n            const user = (await AuthenticationService.getUserById(obj.UserId)).data\n            this.users.push({\n              userId: user.id,\n              name: user.name,\n              surname: user.surname,\n              username: user.username,\n              birthDate: user.birthDate,\n              email: user.email\n            })\n           }\n      var x = document.getElementsByClassName(\"idcolumn\")\n      x[0].style.display = \"none\"\n    }\n  }\n</script>\n"],"sourceRoot":"src\\views"}]}